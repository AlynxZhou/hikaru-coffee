// Generated by CoffeeScript 2.3.1
(function() {
  var Renderer, path;

  path = require("path");

  module.exports = Renderer = class Renderer {
    constructor(logger) {
      // fn: param data, ctx, return Promise
      this.register = this.register.bind(this);
      this.render = this.render.bind(this);
      this.logger = logger;
      this.store = {};
    }

    register(srcExt, docExt, fn) {
      var i, len, s;
      if (srcExt instanceof Array) {
        for (i = 0, len = srcExt.length; i < len; i++) {
          s = srcExt[i];
          this.store[s] = {
            "srcExt": s,
            "docExt": docExt,
            "fn": fn
          };
        }
        return;
      }
      return this.store[srcExt] = {
        "srcExt": srcExt,
        "docExt": docExt,
        "fn": fn
      };
    }

    render(data, ctx) {
      var basename, dirname, docExt, srcExt;
      srcExt = path.extname(data["srcPath"]);
      if (srcExt in this.store) {
        docExt = this.store[srcExt]["docExt"];
        if (docExt != null) {
          dirname = path.dirname(data["srcPath"]);
          basename = path.basename(data["srcPath"], srcExt);
          data["docPath"] = path.join(dirname, `${basename}${docExt}`);
        } else {
          data["docPath"] = data["srcPath"];
        }
        return this.store[srcExt]["fn"](data, ctx);
      }
      data["docPath"] = data["srcPath"];
      return data;
    }

  };

}).call(this);
